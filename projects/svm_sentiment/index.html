<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>SVM: Movie Review Sentiment Classification | Patrick Richter</title> <meta name="author" content="Patrick Richter"/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="machine-learning, artficial-intelligence, deep-learning, neural-networks"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://patrick-richter.github.io/projects/svm_sentiment/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://patrick-richter.github.io/"><span class="font-weight-bold">Patrick</span> Richter</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Machine Learning Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">SVM: Movie Review Sentiment Classification</h1> <p class="post-description"></p> </header> <article> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/1-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/1-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/1-1400.webp"></source> <img class="img-fluid rounded z-depth-1" src="/assets/img/1.jpg" width="auto" height="auto" title="Movie"> </picture> </figure> </div> </div> <p><br><br></p> <h3 id="dataset"><strong>Dataset</strong></h3> <p>The <strong>IMDB movie review dataset</strong> contains reviews along with a <strong>positive or negative sentiment</strong> associated with each movie review (see below for an example). Due to the size of the whole dataset, we will only use a subset here. It contains <strong>5,000 training samples</strong> and <strong>1,500 test samples</strong>. Before we get started, download and save the training data <a href="https://patrick-richter.github.io/assets/csv/movie_review_train.csv">here</a> and the test data <a href="https://patrick-richter.github.io/assets/csv/movie_review_test.csv">here</a> (make sure that you set the format to <code class="language-plaintext highlighter-rouge">Page Source</code>).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sentiment: "negative"
Review: "There's a thin line between being theatrical and being just plain forced. Forced acting. Forced takes. Forced plot. Even forced photography."
</code></pre></div></div> <p><br><br></p> <h3 id="prerequirements"><strong>Prerequirements</strong></h3> <p>The project is written in <strong>Python</strong> and, before starting, make sure to install and import the following <strong>libraries</strong>.</p> <script src="https://gist.github.com/patrick-richter/589d04f8790a130d58c1f4af9244d74a.js"></script> <p><br><br></p> <h3 id="data-preprocessing"><strong>Data Preprocessing</strong></h3> <p>To be able to preprocess the data, the <strong>csv file</strong> is first of all <strong>read with pandas</strong> and transformed into a numpy array. Then, all negative reviews receive the label 0, whereas all positive reviews receive 1 as their label.</p> <script src="https://gist.github.com/patrick-richter/9de6c91da31ae5351c87d684c4a54276.js"></script> <p>The next step is to <strong>remove all stop words</strong> (words such as “the”, “I”, or “he” that occur so frequently that they are deemed irrelevant for the classification), <strong>digits</strong>, and <strong>punctuation</strong>. By using a pre-existing stop word list from the nltk library, the undesirable words can be easily discarded.</p> <script src="https://gist.github.com/patrick-richter/27a5b13e97b7e513bb9a32222697bb98.js"></script> <p>Following that, the remaining words are stemmed, i.e., they are reduced to their base word or stem so that similar words are being represented by the same stem word. For example, ‘leaking’ and ‘leaks’ would both be converted to ‘leak’ and would therefore be seen as the same word in the upcoming steps. Due to better performance, the <strong>Snowball Stemmer</strong>, which is slightly more aggressive than the alternative Porter Stemmer, was implemented.</p> <script src="https://gist.github.com/patrick-richter/29a1779474147d0c7640c24f1c6a5f97.js"></script> <p>Finally, to make our data processable for the SVM classifier, we need to <strong>vectorise the text</strong>. There are several ways how to represent text in a vector. One of the most commonly used approaches that is also used here, is to count the occurrence of words. However, we are not using the normal count vectorsier, and are instead implementing the <strong>Term Frequency Inverse Document Frequency (TF-IDF) vectoriser</strong> here. Rather than only returning the word count, the TF-IDF vectoriser takes into account that some words are more common in general and, therefore, weighs them less.</p> <script src="https://gist.github.com/patrick-richter/dcaf4ff2ecfa3170aa9dfc641cb8d116.js"></script> <p><br><br></p> <h3 id="svm-classifier"><strong>SVM Classifier</strong></h3> <p>A <strong>Support Vector Machines (SVM)</strong> is a supervised Machine Learning algorithm that works really well for text classification problems. It is quick and performs better than Deep Learning algorithms for a small number of samples.</p> <p>In general, SVMs try to find the best hyperplane to split n-dimensional data. This approach works well for linearly seperable data. However, most real-world problems are nonlinear. This is where kernels come into play. <strong>Kernels</strong> transforms linearly inseparable data into a higher-dimensional space, making the data linearly separable again.</p> <p>Finding the right kernel with the fitting <strong>hyperparameters</strong> is the main challenge when designing an SVM classifier. Fortunately, <code class="language-plaintext highlighter-rouge">Scikit-learn</code> offer the <code class="language-plaintext highlighter-rouge">GridSearchCV</code> class that helps finding the right hyperparameters. You can easily input your parameter space and the algorithm will output the best hyperparameter combination. In our case, to speed up the process we are only inputting a subsample of the whole dataset.</p> <script src="https://gist.github.com/patrick-richter/5f9538480c04afb5d0582b56da9c9fde.js"></script> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'C': 10, 'gamma': 0.1, 'kernel': 'sigmoid'} 0.844
</code></pre></div></div> <p><br><br></p> <h3 id="results"><strong>Results</strong></h3> <p>Now, we take the just obtained optimal set of hyperparameters and initialise, fit and assess the SVM classifier.</p> <script src="https://gist.github.com/patrick-richter/6a1f6d10e2864f248bf3e898fd23c035.js"></script> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Train accuracy: 95.82 %
Test accuracy: 86.07 %
</code></pre></div></div> <p>With those hyperparameters, we achieved an <strong>86 % accuracy</strong> on the test dataset, which is quite good considering that we only have a small subset of 6,000 training samples here. However, with a more extensive hyperparameter search (that could take multiple hours), there might be some room for improvement still.</p> <script src="https://gist.github.com/patrick-richter/3363b11ec2aad3ae4907e233e5b5d610.js"></script> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source media="(max-width: 480px)" srcset="/assets/img/20-480.webp"></source> <source media="(max-width: 800px)" srcset="/assets/img/20-800.webp"></source> <source media="(max-width: 1400px)" srcset="/assets/img/20-1400.webp"></source> <img class="img-fluid" src="/assets/img/20.jpg" width="auto" height="auto" title="Confusion matrix"> </picture> </figure> </div> </div> <div class="caption"> Confusion matrix (top left = true negatives, top right = false positives, bottom left = false negatives, and bottom right = true positives) </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2022 Patrick Richter. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script async src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>